version: '3.8'

services:
  # PostgreSQL for MCP server
  postgres:
    image: postgres:16-alpine
    container_name: mcp-postgres
    environment:
      POSTGRES_USER: ${POSTGRES_USER:-mcp_user}
      POSTGRES_PASSWORD: ${POSTGRES_PASSWORD:-mcp_password}
      POSTGRES_DB: ${POSTGRES_DB:-mcp_db}
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data
    networks:
      - mcp-network
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U ${POSTGRES_USER:-mcp_user}"]
      interval: 10s
      timeout: 5s
      retries: 5
    restart: unless-stopped

  # PostgreSQL MCP Server
  postgres-mcp:
    image: node:20-alpine
    container_name: postgres-mcp-server
    command: npx -y @modelcontextprotocol/server-postgres postgresql://${POSTGRES_USER:-mcp_user}:${POSTGRES_PASSWORD:-mcp_password}@postgres:5432/${POSTGRES_DB:-mcp_db}
    depends_on:
      postgres:
        condition: service_healthy
    networks:
      - mcp-network
    restart: unless-stopped

  # SQLite MCP Server
  sqlite-mcp:
    image: node:20-alpine
    container_name: sqlite-mcp-server
    command: npx -y @modelcontextprotocol/server-sqlite /data/database.db
    volumes:
      - ./data/sqlite:/data
    networks:
      - mcp-network
    restart: unless-stopped

  # Filesystem MCP Server
  filesystem-mcp:
    image: node:20-alpine
    container_name: filesystem-mcp-server
    command: npx -y @modelcontextprotocol/server-filesystem /data
    volumes:
      - ./data/filesystem:/data
    networks:
      - mcp-network
    restart: unless-stopped

  # Git MCP Server
  git-mcp:
    image: node:20-alpine
    container_name: git-mcp-server
    command: sh -c "apk add --no-cache git && npx -y @modelcontextprotocol/server-git /repos"
    volumes:
      - ./data/repos:/repos
    networks:
      - mcp-network
    restart: unless-stopped

  # GitHub MCP Server
  github-mcp:
    image: node:20-alpine
    container_name: github-mcp-server
    command: npx -y @modelcontextprotocol/server-github
    environment:
      GITHUB_TOKEN: ${GITHUB_TOKEN}
    networks:
      - mcp-network
    restart: unless-stopped

  # Slack MCP Server
  slack-mcp:
    image: node:20-alpine
    container_name: slack-mcp-server
    command: npx -y @modelcontextprotocol/server-slack
    environment:
      SLACK_BOT_TOKEN: ${SLACK_BOT_TOKEN}
      SLACK_TEAM_ID: ${SLACK_TEAM_ID}
    networks:
      - mcp-network
    restart: unless-stopped

  # Brave Search MCP Server
  brave-search-mcp:
    image: node:20-alpine
    container_name: brave-search-mcp-server
    command: npx -y @modelcontextprotocol/server-brave-search
    environment:
      BRAVE_API_KEY: ${BRAVE_API_KEY}
    networks:
      - mcp-network
    restart: unless-stopped

  # Memory MCP Server
  memory-mcp:
    image: node:20-alpine
    container_name: memory-mcp-server
    command: npx -y @modelcontextprotocol/server-memory
    volumes:
      - memory_data:/root/.mcp-memory
    networks:
      - mcp-network
    restart: unless-stopped

  # Fetch MCP Server (HTTP requests)
  fetch-mcp:
    image: node:20-alpine
    container_name: fetch-mcp-server
    command: npx -y @modelcontextprotocol/server-fetch
    networks:
      - mcp-network
    restart: unless-stopped

  # Puppeteer MCP Server
  puppeteer-mcp:
    image: node:20-alpine
    container_name: puppeteer-mcp-server
    command: sh -c "apk add --no-cache chromium && PUPPETEER_SKIP_CHROMIUM_DOWNLOAD=true PUPPETEER_EXECUTABLE_PATH=/usr/bin/chromium-browser npx -y @modelcontextprotocol/server-puppeteer"
    networks:
      - mcp-network
    restart: unless-stopped

  # Docker MCP Server
  docker-mcp:
    image: node:20-alpine
    container_name: docker-mcp-server
    command: npx -y mcp-server-docker
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    networks:
      - mcp-network
    restart: unless-stopped

  # Prometheus MCP Server
  prometheus-mcp:
    image: node:20-alpine
    container_name: prometheus-mcp-server
    command: npx -y @tumf/mcp-server-prometheus
    environment:
      PROMETHEUS_URL: ${PROMETHEUS_URL:-http://prometheus:9090}
    networks:
      - mcp-network
    restart: unless-stopped

  # MongoDB for MCP
  mongodb:
    image: mongo:7
    container_name: mcp-mongodb
    environment:
      MONGO_INITDB_ROOT_USERNAME: ${MONGO_USER:-mcp_user}
      MONGO_INITDB_ROOT_PASSWORD: ${MONGO_PASSWORD:-mcp_password}
    ports:
      - "27017:27017"
    volumes:
      - mongodb_data:/data/db
    networks:
      - mcp-network
    restart: unless-stopped

  # MongoDB MCP Server
  mongodb-mcp:
    image: node:20-alpine
    container_name: mongodb-mcp-server
    command: npx -y mcp-mongo-server
    environment:
      MONGODB_URI: mongodb://${MONGO_USER:-mcp_user}:${MONGO_PASSWORD:-mcp_password}@mongodb:27017/admin
    depends_on:
      - mongodb
    networks:
      - mcp-network
    restart: unless-stopped

  # MySQL for MCP
  mysql:
    image: mysql:8
    container_name: mcp-mysql
    environment:
      MYSQL_ROOT_PASSWORD: ${MYSQL_ROOT_PASSWORD:-root_password}
      MYSQL_DATABASE: ${MYSQL_DATABASE:-mcp_db}
      MYSQL_USER: ${MYSQL_USER:-mcp_user}
      MYSQL_PASSWORD: ${MYSQL_PASSWORD:-mcp_password}
    ports:
      - "3306:3306"
    volumes:
      - mysql_data:/var/lib/mysql
    networks:
      - mcp-network
    restart: unless-stopped

  # MySQL MCP Server
  mysql-mcp:
    image: node:20-alpine
    container_name: mysql-mcp-server
    command: npx -y @benborla/mcp-server-mysql
    environment:
      MYSQL_HOST: mysql
      MYSQL_USER: ${MYSQL_USER:-mcp_user}
      MYSQL_PASSWORD: ${MYSQL_PASSWORD:-mcp_password}
      MYSQL_DATABASE: ${MYSQL_DATABASE:-mcp_db}
    depends_on:
      - mysql
    networks:
      - mcp-network
    restart: unless-stopped

  # Sequential Thinking MCP Server
  sequential-thinking-mcp:
    image: node:20-alpine
    container_name: sequential-thinking-mcp-server
    command: npx -y @modelcontextprotocol/server-sequential-thinking
    networks:
      - mcp-network
    restart: unless-stopped

  # Google Drive MCP Server
  gdrive-mcp:
    image: node:20-alpine
    container_name: gdrive-mcp-server
    command: npx -y @modelcontextprotocol/server-gdrive
    environment:
      GOOGLE_APPLICATION_CREDENTIALS: /credentials/credentials.json
    volumes:
      - ./credentials:/credentials:ro
    networks:
      - mcp-network
    restart: unless-stopped

  # Google Maps MCP Server
  google-maps-mcp:
    image: node:20-alpine
    container_name: google-maps-mcp-server
    command: npx -y @modelcontextprotocol/server-google-maps
    environment:
      GOOGLE_MAPS_API_KEY: ${GOOGLE_MAPS_API_KEY}
    networks:
      - mcp-network
    restart: unless-stopped

  # Sentry MCP Server
  sentry-mcp:
    image: node:20-alpine
    container_name: sentry-mcp-server
    command: npx -y @modelcontextprotocol/server-sentry
    environment:
      SENTRY_AUTH_TOKEN: ${SENTRY_AUTH_TOKEN}
      SENTRY_ORG: ${SENTRY_ORG}
    networks:
      - mcp-network
    restart: unless-stopped

  # EverArt MCP Server
  everart-mcp:
    image: node:20-alpine
    container_name: everart-mcp-server
    command: npx -y @modelcontextprotocol/server-everart
    environment:
      EVERART_API_KEY: ${EVERART_API_KEY}
    networks:
      - mcp-network
    restart: unless-stopped

  # Time MCP Server (Python)
  time-mcp:
    image: python:3.11-alpine
    container_name: time-mcp-server
    command: sh -c "pip install --no-cache-dir mcp && python -m mcp.server.time"
    networks:
      - mcp-network
    restart: unless-stopped

  # Python Filesystem MCP Server
  python-fs-mcp:
    image: python:3.11-alpine
    container_name: python-fs-mcp-server
    command: sh -c "pip install --no-cache-dir mcp && python -m mcp.server.filesystem /data"
    volumes:
      - ./data/python-fs:/data
    networks:
      - mcp-network
    restart: unless-stopped

networks:
  mcp-network:
    driver: bridge

volumes:
  postgres_data:
  mongodb_data:
  mysql_data:
  memory_data:
